cupy_som_compact.py